@model ReliDemo.ViewModels.HeatSourcesViewModel

@{
    ViewBag.Title = "热原厂基础信息";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>@ViewBag.Title</h2>
@Html.Hidden("hf_compareEastAndWest", "[{ \"label\": \"东部面积\", \"data\": " + @Model.EastFuelInSquareMeter + "}, {\"label\": \"西部面积\", \"data\": " + @Model.WestFuelInSquareMeter + " }]")
@Html.Hidden("hf_compareFossilAndGas", "[{ \"label\": \"燃煤\", \"data\": " + @Model.FuelInFossil + "}, {\"label\": \"燃气\", \"data\": " + @Model.FuelInGas + " }]")
<div class="row-fluid">
    <div  class="box span3">
        <div class="box-content">
            <table>
                <tr>
                    <th>全网供热面积</th>
                    <td>@Model.TotalFuelInSquareMeter 平方米</td>
                </tr>
                <tr>
                    <th>东部</th>
                    <td>@Model.EastFuelInSquareMeter 平方米</td>
                </tr>
                <tr>
                    <th>西部</th>
                    <td>@Model.WestFuelInSquareMeter 平方米</td>
                </tr>
            </table>
        </div>
    </div>
    <div  class="box span3">
        <div class="box-content">
            <div id="placeholder_compareEastAndWest" style="width:100%;height:200px;">
            </div>
        </div>
    </div>
    <div  class="box span3">
        <div class="box-content">
            <div id="placeholder_compareFossilAndGas" style="width:100%;height:200px;">
            </div>
        </div>
    </div>
    <div  class="box span3">
        <div class="box-content">
            <div id="placeholder_comparePeak" style="width:100%;height:200px;">
            </div>
        </div>
    </div>
</div>

<div class="row-fluid">
    <div class="span6">
    <table class="table  table-bordered table-hover  table-condensed" style="background:white">
    @foreach (var p in Model.HeatSources)
    {
        if (@Model.HeatSources.ToList().IndexOf(p) == 0)
        {
            <tr>
            <th>
                @Html.DisplayName("热源名称")
            </th>
            <th>
                @Html.DisplayName("位置")
            </th>
            <th>
                @Html.DisplayName("总供热")
            </th>
            <th>
                @Html.DisplayName("燃煤尖峰炉")
            </th>
            <th>
                @Html.DisplayName("燃气尖峰炉")
            </th>
            <th>
                @Html.DisplayName("机组类型")
            </th>
        </tr>
        }
        <tr>
            <td>
                @Html.ActionLink(p.热源名称, "BasicInfo", new { heatSourceId = p.ItemID })
            </td>
            <td>
                @p.东西部, @p.内外部
            </td>
            <td>
                @p.今日GJ
            </td> 
            <td>
                @p.燃煤尖峰炉数
            </td>
            <td>
                @p.燃气尖峰炉数
            </td>
            <td>
                @p.机组类型
            </td>
        </tr>
    }
    </table>
    </div>

    <div class="span6">
        <div id="placeholder_heatSources" style="height:500px"></div>
    </div>
</div>

<script type="text/javascript">

    $(function () {

        var options = {
            series: {
                pie: {
                    show: true
                }
            }
        };

        var data = $.parseJSON($("input[name=hf_compareEastAndWest]").val());
        $.plot("#placeholder_compareEastAndWest", data, options);

        var data2 = $.parseJSON($("input[name=hf_compareFossilAndGas]").val());
        $.plot("#placeholder_compareFossilAndGas", data2, options);

        var data3 = [{ "label": "供热厂", "data": 12 }, { "label": "尖峰热电厂", "data": 22}];
        $.plot("#placeholder_comparePeak", data3, options);


        function labelFormatter(label, series) {
            return "<div style='font-size:11pt; text-align:center; padding:2px; color:white;'>" + label + "<br/>" + Math.round(series.percent) + "%</div>";
        }

        var data4 = [
	        { label: "宝能", data: 50 },
	        { label: "宝能永泰", data: 30 },
	        { label: "北郊", data: 90 },
	        { label: "北清锅炉房站", data: 70 },
	        { label: "东郊供热厂", data: 90 },
	        { label: "国华汽网", data: 50 },
	        { label: "华能", data: 30 },
	        { label: "京能", data: 90 },
	        { label: "科利源", data: 70 },
	        { label: "青年湖锅炉房", data: 80 },
	        { label: "松榆里供热厂", data: 110 },
	        { label: "特诚", data: 80 },
	        { label: "西马供热厂", data: 70 },
	        { label: "西直门锅炉房", data: 60 },
	        { label: "郑常庄", data: 30 }
        ];

        $.plot("#placeholder_heatSources", data4, {
            series: {
                pie: {
                    show: true,
                    radius: 1,
                    label: {
                        show: true,
                        radius: 2 / 3,
                        formatter: labelFormatter,
                        background: {
                            opacity: 0
                        }
                    }
                }
            },
            legend: {
                show: false
            }
        });

    });

</script>